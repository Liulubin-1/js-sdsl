!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).sdsl={})}(this,function(t){"use strict";var h=function(t){this.val=null,this.pre=null,this.next=null,this.val=t};function e(t){var s=(t=void 0===t?[]:t).length,u=null,i=null;if(s){for(var e=u=new h(t[0]),n=1;n<s;++n)e.next=new h(t[n]),e=(e.next.pre=e).next;i=e}this.size=function(){return s},this.empty=function(){return 0===s},this.clear=function(){u=i=null,s=0},this.forEach=function(t){if("function"!=typeof t)throw new Error("callback must be a function");for(var e=u,n=0;null!=e;)t(e.val,n++),e=e.next},this.front=function(){return null==u?void 0:u.val},this.back=function(){return null==i?void 0:i.val},this.push_front=function(t){++s;t=new h(t);u=u?(t.next=u).pre=t:i=t},this.push_back=function(t){++s;t=new h(t);i?((i.next=t).pre=i,i=t):u=i=t},this.pop_front=function(){s&&--s,u&&(u===i?u=i=null:(u=u.next)&&(u.pre=null))},this.pop_back=function(){s&&--s,i&&(u===i?u=i=null:(i=i.pre)&&(i.next=null))},this.insert=function(t,e,n){if(void 0===n&&(n=1),t<0||s<t)throw new Error("insert pos must more then 0 and less then or equal to the list length");if(n<0)throw new Error("insert size must more then 0");if(0===t)for(;n--;)this.push_front(e);else if(t===s+1)for(;n--;)this.push_back(e);else{for(var r=u,i=1;i<t&&(null!=r&&r.next);++i)r=null==r?void 0:r.next;if(!r||null==r||!r.pre)throw new Error("unknown error");var o=r.next;for(s+=n;n--;)r.next=new h(e),r=(r.next.pre=r).next;(r.next=o)&&(o.pre=r)}},this.eraseElementByPos=function(t){if(t<0||s<=t)throw new Error("insert pos must more then 0 and less then the list length");if(0===t)this.pop_front();else if(t===s-1)this.pop_back();else{for(var e=u;t--&&null!=e&&e.next;)e=e.next;if(!e||!e.pre||!e.next)throw new Error("unknown error");var n=e.pre,r=e.next;(r.pre=n).next=r}s&&--s},this.eraseElementByValue=function(t){for(;u&&u.val===t;)this.pop_front();for(;i&&i.val===t;)this.pop_back();if(u)for(var e,n,r=u.next;r;)r.val===t&&(e=r.pre,(n=r.next)&&(n.pre=e),e&&(e.next=n),s&&--s),r=r.next},this.merge=function(t){var n=this,r=u;t.forEach(function(t){for(;r&&r.val<=t;)r=r.next;var e;r?r===u?(n.push_front(t),r=u):(++s,(e=r.pre)&&(e.next=new h(t),((e.next.pre=e).next.next=r)&&(r.pre=e.next))):(n.push_back(t),r=i)})},this.reverse=function(){for(var t=u,e=i,n=0;t&&e&&2*n<s;){var r=t.val;t.val=e.val,e.val=r,t=t.next,e=e.pre,++n}},this.unique=function(){for(var t=u;t;){for(var e=t;e&&e.next&&e.val===e.next.val;)e=e.next,--s;t.next=e.next,t=t.next}},this.sort=function(t){var e=[];this.forEach(function(t){e.push(t)}),e.sort(t);var n=u;e.forEach(function(t){n&&(n.val=t,n=n.next)})}}function x(t){var f=[],a=0,c=0,l=0,p=0,v=0,k=(t=void 0===t?[]:t).length,e=k*x.sigma,v=Math.ceil(e/x.bucketSize);v=Math.max(v,3);for(var n=0;n<v;++n)f.push(new Array(x.bucketSize));var r=Math.ceil(k/x.bucketSize),l=a=Math.floor(v/2)-Math.floor(r/2);if(0!==k){for(var i=0,n=0;n<r;++n){for(var o=0;o<x.bucketSize;++o)if(f[a+n][o]=t[i++],k<=i){l=a+n,p=o;break}if(k<=i)break}this.size=function(){return k},this.empty=function(){return 0===k},this.clear=function(){a=l=c=p=v=k=0};var s=function(t){for(var e=[],n=Math.max(Math.ceil(t*x.sigma/x.bucketSize),2),r=0;r<n;++r)e.push(new Array(x.bucketSize));var i=Math.ceil(t/x.bucketSize),o=Math.floor(n/2)-Math.floor(i/2),s=o,u=0;if(this.size())for(r=0;r<i;++r){for(var h=0;h<x.bucketSize;++h)if(e[o+r][h]=this.front(),this.pop_front(),this.empty()){s=o+r,u=h;break}if(this.empty())break}f=e,a=o,c=0,l=s,p=u,v=n,k=t};this.forEach=function(t){if(!this.empty()){var e=0;if(a!==l){for(r=c;r<x.bucketSize;++r)t(f[a][r],e++);for(r=a+1;r<l;++r)for(var n=0;n<x.bucketSize;++n)t(f[r][n],e++);for(r=0;r<=p;++r)t(f[l][r],e++)}else for(var r=c;r<=p;++r)t(f[a][r],e++)}},this.front=function(){return f[a][c]},this.back=function(){return f[l][p]},this.push_front=function(t){this.empty()||(0===a&&0===c&&s.call(this,this.size()),0<c?--c:0<a&&(--a,c=x.bucketSize-1)),++k,f[a][c]=t},this.push_back=function(t){this.empty()||(l===v-1&&p===x.bucketSize-1&&s.call(this,this.size()),p<x.bucketSize-1?++p:l<v-1&&(++l,p=0)),++k,f[l][p]=t},this.pop_front=function(){this.empty()||(1!==this.size()&&(c<x.bucketSize-1?++c:a<l&&(++a,c=0)),--k)},this.pop_back=function(){this.empty()||(1!==this.size()&&(0<p?--p:a<l&&(--l,p=x.bucketSize-1)),--k)};var h=function(t){var e=a*x.bucketSize+c,t=e+t;if(t<e||l*x.bucketSize+p<t)throw new Error("pos should more than 0 and less than queue's size");return{curNodeBucketIndex:Math.floor(t/x.bucketSize),curNodePointerIndex:t%x.bucketSize}};this.getElementByPos=function(t){var e=h(t),t=e.curNodeBucketIndex,e=e.curNodePointerIndex;return f[t][e]},this.setElementByPos=function(t,e){var n=h(t),t=n.curNodeBucketIndex,n=n.curNodePointerIndex;f[t][n]=e},this.shrinkToFit=function(){var e=[];this.forEach(function(t){e.push(t)});var t=e.length;f=[];for(var n=Math.ceil(t/x.bucketSize),r=0;r<n;++r)f.push(new Array(x.bucketSize));this.clear();for(var i=0,r=0;r<n;++r)for(var o=0;o<x.bucketSize;++o)if(f[r][o]=e[i++],t<=i){l=r,p=o;break}k=t},this.insert=function(t,e,n){var r=this;if(void 0===n&&(n=1),0===t)for(;n--;)this.push_front(e);else if(t===this.size())for(;n--;)this.push_back(e);else{for(var i=h(t),o=i.curNodeBucketIndex,i=i.curNodePointerIndex,s=[],u=t;u<k;++u)s.push(this.getElementByPos(u));l=o,p=i,k=t+1,this.pop_back();for(u=0;u<n;++u)this.push_back(e);s.forEach(function(t){return r.push_back(t)})}},this.cut=function(t){var e=h(t),n=e.curNodeBucketIndex,e=e.curNodePointerIndex;l=n,p=e,k=t+1},this.eraseElementByPos=function(t){var e=this;if(0===t)this.pop_front();else if(t===this.size())this.pop_back();else{for(var n=[],r=t+1;r<k;++r)n.push(this.getElementByPos(r));this.cut(t),this.pop_back(),n.forEach(function(t){return e.push_back(t)})}},this.eraseElementByValue=function(e){var n=[];this.forEach(function(t){t!=e&&n.push(t)});for(var t=n.length,r=0;r<t;++r)this.setElementByPos(r,n[r]);this.cut(t-1)},this.reverse=function(){for(var t=0,e=k-1;t<e;){var n=this.getElementByPos(t);this.setElementByPos(t,this.getElementByPos(e)),this.setElementByPos(e,n),++t,--e}},this.unique=function(){if(!this.empty()){var n=[],r=this.front();this.forEach(function(t,e){0!==e&&t===r||(n.push(t),r=t)});for(var t=0;t<k;++t)this.setElementByPos(t,n[t]);this.cut(n.length-1)}},this.sort=function(t){var e=[];this.forEach(function(t){e.push(t)}),e.sort(t);for(var n=0;n<k;++n)this.setElementByPos(n,e[n])}}}Object.freeze(e),x.sigma=3,x.bucketSize=5e3,Object.freeze(x),t.Deque=x,t.LinkList=e,Object.defineProperty(t,"__esModule",{value:!0})});